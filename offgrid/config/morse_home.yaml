tick_interval: 2s
queue_size: 1000
inputs:
  # - name: power_meter
  #   reader:      
  #     type: ModbusReader
  #     transport:
  #       type: TCP
  #       host: 127.0.0.1
  #       port: 9872
  #     tick_interval: 1s
  #     register_map: csv::config/power_meter_registers.csv
  #   transformer:
  #     type: OffGridTransformer


  - name: power_meter_RTU
    reader:
      type: ModbusReader
      transport:
        type: RTU
        tty_path: "/dev/ttyUSB0"
        slave_id: 0x0
        data_bits: Eight
        stop_bits: One
        parity: Even
      register_map: csv::config/power_meter_registers.csv
      read_interval: 5s
      timeout: 1s


outputs:
  - name: console
    batch_size: 1
    flush_interval: 4s
    writer_timeout: 0.5m
    writer:
      type: ConsoleWriter
      timestamp: true
      fields: [v1, v2, v3]

  - name: mqtt-writer
    batch_size: 10
    flush_interval: 4s
    writer_timeout: 0.5m
    writer:
      type: MqttWriter
      host: mqtt.hy2b.sysmoltd.com
      port: 31893
      client_id: morse-home-1
      topic: morse-home
      tls_ca: cert/ca-sysmo.crt
      tls_crt: cert/morse-home.crt
      tls_key: cert/morse-home.key

  - name: influxdb-writer
    batch_size: 10
    flush_interval: 5s
    writer_timeout: 0.5m
    writer:
      type: InfluxDbWriter
      url: https://eu-central-1-1.aws.cloud2.influxdata.com
      org: sysmo
      bucket: morse-home-bucket
      token: "V51MEOS_QEms194cMZ6HbgVKcu_1Kw_Hy3J8R8aMtvjBLGjlxqFpwNkKQSLHyrdl-uyt7gisaJy8SXcDZTsdqg=="
